import{g as i}from"./utils-BLWznkn2.js";let s,c=crypto.randomUUID();const o={};document.getElementById("startStream").onclick=async()=>{s=await navigator.mediaDevices.getDisplayMedia({video:!0})};const t=new WebSocket(`${i()}?role=streamer&streamId=${c}`);function l(e){const a=new SimplePeer({initiator:!0,trickle:!1,stream:s});a.on("signal",n=>{t.send(JSON.stringify({streamer:!0,type:"signal",viewerId:e,data:n}))}),o[e]=a}function d(e,a){o[e]&&o[e].signal(a)}t.onopen=()=>{};const r=e=>{const a=JSON.parse(e);if(a.viewer)switch(a.type){case"signal":{d(a.viewerId,a.data);break}case"addViewer":{l(a.viewerId);break}}};t.onmessage=async e=>{if(e.data instanceof Blob){const a=await e.data.text();r(a)}else r(e.data)};t.onclose=()=>{console.log("WebSocket connection closed")};t.onerror=e=>{console.error("WebSocket error:",e)};
